#!/usr/bin/env bash

set -e

BIN_PATH="$1/bin"
TMP_PATH="$1/tmp"
mkdir -p $BIN_PATH $TMP_PATH

# Binary location
BIN_DIR=$(cd $(dirname $0); pwd) # absolute path
OPT_DIR=$(cd "$BIN_DIR/../opt"; pwd)



WKHTMLTOPDF_PKG="$OPT_DIR/wkhtmltopdf.tar.xz"
WKHTMLTOPDF_PATH="$TMP_PATH"
WKHTMLTOPDF_BINARIES="$WKHTMLTOPDF_PATH/wkhtmltox/bin"


echo "-----> Unpacking Debian package"
tar -xJf $WKHTMLTOPDF_PKG -C $WKHTMLTOPDF_PATH

echo "-----> Setting permissions"
chmod +x $WKHTMLTOPDF_BINARIES/*

echo "-----> Moving binaries to the right place"
cp $WKHTMLTOPDF_BINARIES/* $BIN_PATH/

exit 0